# Проектирование главной страницы и типов контента

## Обзор

Документ описывает архитектуру главной страницы консалтингового сайта по внедрению GenAI-решений и все необходимые типы контента в Payload CMS.

## Цели проекта

- Создать убедительную главную страницу, демонстрирующую экспертизу в GenAI
- Обеспечить гибкость в управлении контентом через Payload CMS
- Реализовать структурированное представление кейсов и экспертизы
- Интегрировать форму для лид-генерации

## Архитектура контента

### 1. Коллекции Payload CMS

#### 1.1. Коллекция `Cases` (новая)

Коллекция для управления кейсами внедрения AI-решений.

**Поля:**
- `title` (text, required) - Название кейса/компании
- `slug` (text, unique, required) - URL-friendly идентификатор
- `industry` (select) - Отрасль клиента (ДКС/Металлопрокат/Юридические услуги/Другое)
- `challenge` (textarea, required) - Описание задачи клиента
- `solution` (richText) - Подробное описание решения
- `results` (richText, required) - Достигнутые результаты (с метриками)
- `shortDescription` (textarea, required) - Краткое описание для карточки (до 150 символов)
- `coverImage` (upload, relationship to Media) - Изображение для превью
- `technologies` (array of text) - Использованные технологии
- `featured` (checkbox) - Показывать на главной странице
- `publishedDate` (date) - Дата публикации
- `status` (select: draft/published) - Статус публикации

**Настройки:**
- Включить drafts
- Включить versions
- Admin list: показывать title, industry, status, featured

#### 1.2. Использование встроенного Form Builder

Для формы обратной связи используем `@payloadcms/plugin-form-builder` (уже установлен в проекте).

**Создадим форму в админке с полями:**
- Имя (text, required)
- Компания (text)
- Email (email, required)
- Телефон (text, phone validation)
- Описание задачи (textarea, required)

**Настройки формы:**
- Email-уведомления администратору при новой заявке
- Redirect после успешной отправки на страницу благодарности
- Сохранение submissions в Payload
- Spam protection (встроенная в Form Builder)

#### 1.3. Модификация коллекции `Pages`

Добавить новые блоки в Layout Builder для главной страницы.

#### 1.4. Использование существующей коллекции `Posts`

Для раздела "Экспертиза" использовать существующую коллекцию `Posts` с категорией "AI Insights" или "Экспертиза".

---

### 2. Новые блоки для Layout Builder

#### 2.1. Блок `HeroHome`

**Назначение:** Главный экран с заголовком и CTA-кнопками.

**Поля:**
- `heading` (text, required) - Основной заголовок
- `subheading` (textarea, required) - Подзаголовок
- `primaryCTA` (group):
  - `text` (text) - Текст кнопки
  - `link` (text) - Якорная ссылка (например, #form)
- `secondaryCTA` (group):
  - `text` (text) - Текст кнопки
  - `link` (text) - Якорная ссылка (например, #cases)
- `mediaType` (select: image/video) - Тип фонового медиа
- `backgroundImage` (upload, relationship to Media) - Фоновое изображение
- `backgroundVideo` (upload, relationship to Media) - Фоновое видео (формат MP4/WebM)
- `backgroundOverlay` (checkbox, default: true) - Использовать затемнение фона для читаемости текста

**Компоненты React:**
- Использовать shadcn/ui: `Button`, `Container`
- Адаптивная типографика
- Gradient overlay для читаемости

---

#### 2.2. Блок `TargetAudience`

**Назначение:** Секция "Кому будут полезны GenAI-решения".

**Поля:**
- `heading` (text, required) - Заголовок секции
- `audiences` (array, min: 2, max: 6):
  - `title` (text, required) - Заголовок карточки
  - `description` (textarea, required) - Описание
  - `icon` (text) - Название иконки из react-icons (например, 'FaUserTie', 'FaBriefcase')

**Компоненты React:**
- shadcn/ui: `Card`, `Grid`
- Responsive grid (1 колонка на mobile, 2 на tablet, 4 на desktop)
- Hover-эффекты на карточках

---

#### 2.3. Блок `SolutionApproach`

**Назначение:** Описание подхода к решению задач клиента.

**Поля:**
- `heading` (text, required) - Заголовок секции
- `subheading` (textarea) - Подзаголовок
- `steps` (array, min: 3, max: 5):
  - `title` (text, required) - Название этапа
  - `description` (textarea, required) - Описание
  - `icon` (text) - Название иконки из react-icons (например, 'FaChartLine', 'FaCog')
  - `order` (number, auto-increment) - Порядковый номер

**Компоненты React:**
- shadcn/ui: Feature section с иконками
- Вертикальная timeline на desktop, карточки на mobile
- Анимация появления при скролле

---

#### 2.4. Блок `FeaturedCases`

**Назначение:** Витрина избранных кейсов.

**Поля:**
- `heading` (text, required) - Заголовок секции
- `casesToShow` (number, default: 3) - Количество кейсов
- `autoSelect` (checkbox, default: true) - Автоматически выбрать featured кейсы
- `manualCases` (relationship to Cases, array) - Ручной выбор кейсов (если autoSelect = false)
- `ctaText` (text) - Текст кнопки "Посмотреть все кейсы"
- `ctaLink` (text) - Ссылка на страницу всех кейсов

**Компоненты React:**
- shadcn/ui: `Grid` + `Card`
- Grid layout: 1 колонка mobile, 2 колонки tablet, 3 колонки desktop
- Показывать: coverImage, title, shortDescription, кнопка "Подробнее"
- Lazy loading для изображений

---

#### 2.5. Блок `ExpertiseHighlight`

**Назначение:** Секция блога/экспертизы.

**Поля:**
- `heading` (text, required) - Заголовок секции
- `subheading` (textarea) - Подзаголовок
- `category` (relationship to Categories) - Фильтр по категории (например, "AI Insights")
- `postsToShow` (number, default: 3) - Количество постов
- `ctaText` (text) - Текст кнопки "Перейти в блог"
- `ctaLink` (text) - Ссылка на страницу блога

**Компоненты React:**
- shadcn/ui: `Grid` + `Card`
- Показывать: заголовок поста, дата, краткое описание, автор
- Ссылки на полные статьи

---

#### 2.6. Блок `ContactForm`

**Назначение:** Форма обратной связи через встроенный Form Builder.

**Поля:**
- `heading` (text, required) - Заголовок секции
- `description` (textarea) - Пояснительный текст над формой
- `form` (relationship to Forms) - Выбор формы из Form Builder
- `formId` (text) - HTML ID для якорной ссылки (по умолчанию: "form")

**Компоненты React:**
- Использовать готовый компонент FormBlock из template
- Встроенная валидация из Form Builder
- Автоматическая отправка на email и сохранение в Payload

---

### 3. Структура главной страницы

Страница создается в коллекции `Pages` со следующими блоками в порядке:

1. **HeroHome** - Главный экран (с видео/изображением фона)
2. **TargetAudience** - Кому полезны решения
3. **SolutionApproach** - Наш подход
4. **FeaturedCases** - Кейсы (grid layout на desktop)
5. **ExpertiseHighlight** - Блог/Экспертиза
6. **ContactForm** - Форма обратной связи (Form Builder)

---

## План реализации

### Этап 1: Подготовка и согласование
- ✅ Создание документации
- ⏳ Получение ответов на уточняющие вопросы
- ⏳ Согласование структуры данных и блоков
- ⏳ Финализация дизайн-решений

**Результат этапа:** Согласованная документация, готовая к реализации.

---

### Этап 2: Создание коллекций и форм в Payload CMS
- Создание коллекции `Cases` с полями и настройками
- Создание страницы для отдельного кейса (template)
- Создание формы обратной связи через Form Builder в админке
- Настройка email-уведомлений для формы
- Генерация TypeScript типов (`pnpm payload generate:types`)
- Создание и применение миграций БД (`pnpm payload migrate:create && pnpm payload migrate`)

**Результат этапа:** Коллекция Cases работает, форма создана в Form Builder и настроена для использования.

---

### Этап 3: Разработка блоков Layout Builder (часть 1)
- Создание блока `HeroHome`:
  - Конфигурация в `src/blocks/HeroHome/config.ts`
  - React-компонент в `src/blocks/HeroHome/Component.tsx`
  - Поддержка видео и изображения фона
  - Якорные ссылки для CTA-кнопок
- Создание блока `TargetAudience`:
  - Конфигурация с массивом аудиторий
  - Адаптивный grid с карточками
  - Динамическая загрузка иконок из react-icons
- Регистрация блоков в `src/payload.config.ts`
- Добавление блоков в `RenderBlocks.tsx`

**Результат этапа:** Два верхних блока главной страницы работают, поддержка видео/изображения фона.

---

### Этап 4: Разработка блоков Layout Builder (часть 2)
- Создание блока `SolutionApproach`:
  - Timeline-компонент для desktop
  - Карточки для mobile
  - Иконки из react-icons
  - Анимация появления при скролле
- Создание блока `FeaturedCases`:
  - Интеграция с коллекцией Cases
  - Grid layout (1/2/3 колонки)
  - Логика автовыбора featured кейсов
  - Ссылки на страницы отдельных кейсов
- Тестирование связей между коллекциями

**Результат этапа:** Блоки "Решение" и "Кейсы" функционируют, grid работает адаптивно.

---

### Этап 5: Разработка блоков Layout Builder (часть 3)
- Создание блока `ExpertiseHighlight`:
  - Интеграция с коллекцией Posts
  - Фильтрация по категориям
  - Карточки постов с мета-информацией
- Создание блока `ContactForm`:
  - Интеграция с Form Builder
  - Использование готового FormBlock компонента
  - HTML ID для якорной ссылки
- Создание страницы благодарности (Thank You page)

**Результат этапа:** Все блоки главной страницы готовы, форма работает через Form Builder.

---

### Этап 6: Создание и наполнение главной страницы
- Создание страницы "Главная" в коллекции Pages
- Добавление всех блоков в Layout Builder
- Заполнение тестовым контентом
- Настройка slug и SEO-метаданных
- Проверка Live Preview

**Результат этапа:** Главная страница собрана и доступна по корневому URL.

---

### Этап 7: Стилизация и адаптивность
- Применение TailwindCSS стилей ко всем блокам
- Настройка адаптивности для mobile/tablet/desktop
- Добавление hover-эффектов и transitions
- Оптимизация изображений (Next.js Image)
- Проверка accessibility (ARIA labels, keyboard navigation)

**Результат этапа:** Красиво оформленная, адаптивная главная страница.

---

### Этап 8: Тестирование и оптимизация
- Unit-тесты для блоков (Vitest)
- E2E тесты для формы (Playwright)
- Проверка типов TypeScript (`tsc --noEmit`)
- Линтинг (`pnpm lint:fix`)
- Тестирование отправки формы и получения email
- Performance audit (Lighthouse)

**Результат этапа:** Протестированный, оптимизированный код без ошибок.

---

### Этап 9: Seed-данные и документация
- Создание seed-функции для:
  - 3-4 примера кейсов (Cases)
  - 2-3 статьи в блоге (Posts)
  - Главная страница с заполненными блоками
- Обновление документации в `docs/`
- Добавление инструкций по редактированию контента

**Результат этапа:** Готовая к демонстрации главная страница с реалистичными данными.

---

## Технические детали

### API Endpoints

**GET /api/cases?featured=true** - Получение featured кейсов для блока FeaturedCases

**Формы:** Обрабатываются автоматически через Form Builder plugin (встроенные endpoints)

---

### TypeScript типы (после генерации)

```typescript
// Будут автоматически сгенерированы Payload
import { Case, Lead } from '@/payload-types'

// Пример использования в компонентах
interface FeaturedCasesProps {
  cases: Case[];
  heading: string;
  displayMode: 'carousel' | 'grid';
}
```

---

### Интеграция с существующими компонентами

- Использовать существующий `RenderBlocks.tsx` для рендера новых блоков
- Переиспользовать стили из `src/components`
- Следовать паттернам работы с Media из существующего `MediaBlock`

---

## Зависимости

**Новые пакеты (если потребуются):**
- `react-icons` - для иконок в блоках (если ещё не установлен)
- Остальные зависимости уже есть в проекте

---

## ✅ Согласованные решения

1. **Форма обратной связи**: Используем встроенный Form Builder ✅
2. **Кейсы**: Отдельная коллекция Cases со страницами для каждого кейса ✅
3. **Блог**: Используем существующую коллекцию Posts ✅
4. **Hero Section**: Поддержка видео и изображения фона, CTA-кнопки с якорными ссылками ✅
5. **Локализация**: Только русская версия ✅
6. **Иконки**: React-icons (набор по умолчанию из shadcn) ✅
7. **Layout кейсов**: Grid на desktop (1/2/3 колонки адаптивно) ✅

---

## Следующие шаги

1. ✅ Документация согласована
2. ⏳ Утвердить email для уведомлений о заявках (потребуется для настройки Form Builder)
3. ⏳ Подтвердить готовность к началу разработки
4. ⏳ Приступить к Этапу 2 (создание коллекции Cases и формы)

---

*Документ создан: 2025-10-27*
*Статус: Согласовано, готово к реализации*
